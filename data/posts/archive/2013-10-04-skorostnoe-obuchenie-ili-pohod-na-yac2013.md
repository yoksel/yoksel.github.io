---
title: Скоростное обучение или поход на YAC2013

tags: [fonts]
---

2 октября прошла конференция <a href="http://tech.yandex.ru/events/yac/2013/">Yet another Conference 2013</a> от Яндекса. Было много интересного, но самое яркое впечатление оставил <a href="https://github.com/yandex-cs/yac2013">конкурс по ускорению отрисовки страницы</a>.<!--more-->

Задание было забористое, с подковырками. На выполнение около суток.
Помимо совершенно очевидных вещей в нём было несколько хорошо спрятанных секретов. Некоторые из них заставили поломать голову в процессе решения задачи, некоторые не отпускали и на следующий день :&nbsp;)

Одно из таких — оптимизация шрифтов.

Клонируем себе проект, открываем папочку со шрифтами и видим там слонов:

<img src="//img-fotki.yandex.ru/get/9358/5091629.98/0_7b9a4_f69346d4_L.png" alt="Font Elefants" />

Это шрифт PT Sans, который можно скачать бесплатно, например, прямо с сайта производителя: <a href="http://www.paratype.ru/public/">paratype.ru/public/</a>. Там же предлагается вместо скачивания шрифта подключить его через <a href="http://www.google.com/fonts">google.com/fonts</a>.

Простейшая оптимизация заключается в отключении неиспользуемого шрифта. В файле подключается 4 шрифта, и один из них не используется (PT Sans Narrow Bold).

А вот дальше начинается самое интересное. На <a href="http://www.paratype.ru/public/">paratype.ru</a> написано, что:

<blockquote>ПТ Санс, ПТ Сериф и ПТ Моно поддерживают обширный список языков Евразии на латинской и кириллической основе. <...>

Важной особенностью шрифтов является поддержка всех официальных и большинства титульных языков народов и народностей РФ, которые приведены ниже. </blockquote>

И ниже список из 54-х языков. Таким образом, просто подключая шрифт как есть, мы за компанию получаем кучу символов, которые врядли нам когда-нибудь потребуются.

И вот теперь самое время воспользоваться <a href="http://www.google.com/fonts">google.com/fonts</a>.

Находим там PT Sans, выбираем обычный и жирный шрифт (наклонный в задании не используется), выбираем кириллицу, получаем код и скачиваем файлы по ссылкам, чтобы оценить вес.

На выходе два файла названные абракадаброй и весом 127 и 137кб (против 224 и 238кб).
Уже лучше, но и это не предел.

В разделе выбора языков есть ссылка <a href="https://developers.google.com/fonts/docs/getting_started#Subsets">Read more on how to use subsets</a>. На странице по ссылке содержится ценный совет: чтобы использовать только нужный набор символов, его можно задать в URL через параметр text:

<em>http://fonts.googleapis.com/css?family=Inconsolata<strong>&text=Hello</strong></em>

Параметр subset в этом случае задавать не нужно.

<strong>Результат:</strong> PT Sans Bold весит всего 7.6kb. Он используется только в заголовке, и символов для него нужно совсем немного. 7.6 против 238 килобайт!

Аналогично делаем для нежирного начертания, в параметр text вводим все кириллические символы, латиницу и цифры. В итоге получаем файл весом около 15-ти килобайт. 15 вместо 224kb!

Отличный выигрыш в производительности и весе страницы дает этот простой как лом способ, жаль, что я не смогла им воспользоваться на конкурсе.

Если бы шрифта не было на гугле, пришлось бы воспользоваться редактором шрифта, а это уже совсем другая история.

Спасибо Яндексу за интересный конкурс, благодаря ему мы за очень короткое время узнали много нового, не только про шрифты. Надеемся, что будут другие, не менее увлекательные и полезные, и, желательно, не по ночам : )

<strong>Ссылки по теме:</strong>
<a href="http://habrahabr.ru/post/130172/">habrahabr.ru/post/130172/</a>

<strong>Видео по теме:</strong>
отличный ролик про оптимизацию шрифта на <a href="http://www.fontsquirrel.com/">белке-шрифтелке</a>.
Для конкурса этот способ не подошел, потому что сайт не захотел закачивать PT Sans, аргументируя это просьбой правообладателей. При этом сам шрифт можно свободно скачать с сайта, а вот модифицировать его — нет.

<iframe width="640" height="480" src="//www.youtube.com/embed/G5ZmSVK7CHo" frameborder="0" allowfullscreen></iframe>
