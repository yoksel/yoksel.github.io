{"pageProps":{"article":{"title":"Трюк на CSS для поддержки SVG в старых браузерах","slug":"svg-fallback-in-ie9-and-androids2x","content":"<p>Как-то у меня возник интересный вопрос. Есть <a href=\"https://www.npmjs.org/package/svg_fallback\">решение</a> для замены инлайнового SVG на фоновые картинки в браузерах, где инлайновый SVG не поддерживается. Оно построено на допущении, что на странице есть нужный нам класс <code>.ie8</code>, по которому SVG-элементам включаются фоновые изображения.</p>\n<p>Очевидный недостаток способа состоит в том, что мы должны  отдельно позаботиться о том, чтобы нужный нам класс был — при генерации страницы на сервере или же определив браузер с помощью JS.</p>\n\n\n<p>Второй очевидный недостаток состоит в том, что способ не годится для других браузеров без поддержки инлайнового SVG, например, Оперы Мини и Андроидов 2.x.</p>\n<p>Мне стало интересно: можно ли обеспечить поддержку во всех старых браузерах, используя только CSS?</p>\n<p>И, кажется, я нашла решение. Оно странное, но работает. Меня интересовала его работоспособность в следующих браузерах:</p>\n<ul>\n<li>IE8 и 9</li>\n<li>Android 2.x</li>\n<li>Opera 12, Opera Mini</li>\n</ul>\n<p>Тестировалось вот на такой конструкции:</p>\n<p> SVG:</p>\n<figure aria-label=\"Пример кода\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>svg-icon<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>circle</span> <span class=\"token attr-name\">r</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>55<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>50%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>50%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>yellowgreen<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>text</span> <span class=\"token attr-name\">x</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>50%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">y</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>50%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>.4em<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">text-anchor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>middle<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">font</span><span class=\"token punctuation\">:</span> 38px/1 Trebuchet MS<span class=\"token punctuation\">;</span> <span class=\"token property\">fill</span><span class=\"token punctuation\">:</span> #FFF</span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>SVG<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>text</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span>\n</code></pre></figure>\n<p>CSS:</p>\n<figure aria-label=\"Пример кода\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.svg-icon</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 3em 2em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 180px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 130px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>https://img-fotki.yandex.ru/get/5807/5091629.a3/0_86371_b2660de0_orig<span class=\"token punctuation\">)</span></span>\n        no-repeat center center<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid #555<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></figure>\n<p>Если SVG не поддерживается браузером, мы увидим — только эту фоновую картинку:</p>\n<img src=\"https://img-fotki.yandex.ru/get/5807/5091629.a3/0_86371_b2660de0_orig\"/>\n\n<p>Если поддерживается — и фон, и SVG. Если вы смотрите страницу в современном браузере, демо покажет вам именно этот вариант:</p>\n<p data-height=\"350\" data-theme-id=\"4974\" data-slug-hash=\"sbzEp\" data-default-tab=\"result\" data-user=\"yoksel\" class='codepen'>See the Pen <a href='https://codepen.io/yoksel/pen/sbzEp/'>Test support of SVG fallback</a> by yoksel (<a href='https://codepen.io/yoksel'>@yoksel</a>) on <a href='https://codepen.io'>CodePen</a>.</p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n\n<p><i>На самом деле, в браузерах без поддержки SVG также будет виден текст &quot;SVG&quot;, но в реальной жизни это вряд ли будет проблемой, если только вы не кладете текст в иконки.</i></p>\n<p>Задача состоит в том, чтобы в браузерах с поддержкой SVG убирать фон.</p>\n<p>Картинки для понятности:</p>\n<p><img src=\"https://img-fotki.yandex.ru/get/6734/5091629.a3/0_86377_63bd7b1e_orig\" class=\"vlm\"/> — сейчас демо выглядит вот так</p>\n<p><img src=\"https://img-fotki.yandex.ru/get/6828/5091629.a3/0_86372_1655bbc0_orig.png\" class=\"vlm\"/> — так оно должно выглядеть в браузерах без поддержки SVG</p>\n<p><img src=\"https://img-fotki.yandex.ru/get/2914/5091629.a3/0_86378_6105ccc8_orig\" class=\"vlm\"/> — а вот так в браузерах, где SVG поддерживается</p>\n<p>То есть по умолчанию всегда показывается PNG-заглушка, и её нужно скрыть только в современных браузерах. Нам нужна некая конструкция в CSS, поддержка которой в разных браузерах совпадает с поддержкой SVG.</p>\n<p>Первым делом в голову приходит вариант с множественными фонами, например:</p>\n<figure aria-label=\"Пример кода\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">,</span> none<span class=\"token punctuation\">;</span>\n</code></pre></figure>\n<p>Хороший вариант, но браузеры Android 2.x понимают множественные фоны и не понимают SVG, поэтому в них при таком способе на странице не будет ни того, ни другого.</p>\n<p>Ссылка для тестирования: <a href=\"https://codepen.io/yoksel/full/FirKg\">https://codepen.io/yoksel/full/FirKg</a>.</p>\n<p>Следующая идея убирать фон с помощью <a href=\"http://pauginer.com/post/36614680636/invisible-gradient-technique\">невидимого градиента</a>.</p>\n<p>Примерный код:</p>\n<figure aria-label=\"Пример кода\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">linear-gradient</span><span class=\"token punctuation\">(</span>transparent<span class=\"token punctuation\">,</span> transparent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></figure>\n<p>Способ работает везде, где нужно, кроме IE9 — он не понимает градиенты, поэтому в нем будут отображаться и SVG, и фон.</p>\n<p>Ссылка для тестирования: <a href=\"https://codepen.io/yoksel/full/fxCzH\">https://codepen.io/yoksel/full/fxCzH</a>.</p>\n<p>Нужно какое-то решение, которое уберет фон в IE9 и ничего не поломает в остальных.</p>\n<p>Мне не удалось найти ничего подходящего в CSS-свойствах для <a href=\"http://caniuse.com/#search=background\">управления фоном</a>, но зато кое-что интересное неожиданно обнаружилось в <a href=\"http://caniuse.com/#search=viewport%20units\">единицах измерения</a>.</p>\n<p>Если для управления размерами или положением фона использовать единицы вьюпорта — <code>vw</code>  или <code>vh</code>, браузеры Android 2.x и Opera Mini полностью проигнорируют свойство, где они содержатся. То есть можно написать:</p>\n<figure aria-label=\"Пример кода\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token property\">background-position</span><span class=\"token punctuation\">:</span> -1000vh 0<span class=\"token punctuation\">;</span>\n</code></pre></figure>\n<p>и этот код уберет фоновое изображение в IE9.</p>\n<p>Не все браузеры понимают единицы вьюпорта, так что в финальной версии кода нужно комбинировать оба последних способа:</p>\n<figure aria-label=\"Пример кода\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* современные браузеры кроме IE9 */</span>\n<span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">linear-gradient</span><span class=\"token punctuation\">(</span>transparent<span class=\"token punctuation\">,</span> transparent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token comment\">/* IE9 */</span>\n<span class=\"token property\">background-position</span><span class=\"token punctuation\">:</span> -1000vh 0<span class=\"token punctuation\">;</span>\n</code></pre></figure>\n<p>Демо:</p>\n<p data-height=\"350\" data-theme-id=\"4974\" data-slug-hash=\"tKzeB\" data-default-tab=\"result\" data-user=\"yoksel\" class='codepen'>See the Pen <a href='https://codepen.io/yoksel/pen/tKzeB/'>Test support of SVG fallback</a> by yoksel (<a href='https://codepen.io/yoksel'>@yoksel</a>) on <a href='https://codepen.io'>CodePen</a>.</p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n\n<p>Ссылка для тестирования: <a href=\"https://codepen.io/yoksel/full/tKzeB\">codepen.io/yoksel/full/tKzeB</a></p>\n<p>Возможно, я что-то упустила, но на данный момент мои тесты показывают, что этот способ работает.</p>\n<p>Браузеры, где проверяла:</p>\n<ul>\n<li>IE8 и 9</li>\n<li>Android 2.3</li>\n<li>Opera 12, Opera Mini</li>\n</ul>\n<p>Для проверки в Android 2.3 я использовала <a href=\"http://www.browserstack.com/screenshots\">browserstack.com/screenshots</a>, выбрав там Samsung Galaxy S2. Буду признательна, если кто-то потестит на реальном девайсе и сообщит о результатах.</p>\n<p>Вообще если у вас есть возможность потестить <a href=\"https://codepen.io/yoksel/full/tKzeB\">демо</a> на устройствах, где может быть проблема с инлайновым SVG, — проверьте, пожалуйста, и сообщите как оно там — этот способ на данный момент нуждается в основательном тестировании.</p>\n<p>Хочется надеяться, что постепенно старые устройства канут в лету, и нам больше не надо будет изобретать такие странные решения на стыке магии и CSS.</p>\n","links":[{"href":"http://pauginer.com/post/36614680636/invisible-gradient-technique","text":"The invisible gradient technique: Cross-browser support for SVG (with image fallback) using CSS"},{"href":"/svg-in-ie8","text":"Грабли на чистом SVG"},{"href":"https://www.npmjs.org/package/svg_fallback","text":"svg_fallback (plugin)"},{"href":"/grunt-plugin","text":"Зачем я написала плагин для Grunt"},{"href":"http://blogs.telerik.com/kendoui/posts/12-02-17/using_svg_on_android_2_x_and_kendo_ui_dataviz","text":"Using SVG on Android 2.x"}],"tags":["svg"],"navItems":[],"date":"2014-11-01"},"posts":[{"date":"2020-09-26","href":"/css-math","text":"Математические функции в CSS","type":"post"},{"date":"2020-09-24","href":"/adaptive-video-with-css-math","text":"Адаптивное видео с помощью встроенных математических функций CSS","type":"post"},{"date":"2020-08-30","href":"/inaccessibility","text":"Недоступность в картинках","type":"post"},{"date":"2020-08-13","href":"/size-units","text":"Единицы размеров в CSS","type":"post"},{"date":"2020-07-27","href":"/color-themes-generator","text":"Генератор цветовых тем","type":"post"},{"date":"2020-07-25","href":"/jekyll-gatsby","text":"Jekyll → Gatsby","type":"post"},{"date":"2018-06-18","href":"/opentype-variable-fonts","text":"Вариативные шрифты","type":"post"},{"date":"2017-08-15","href":"/svg-sizes","text":"Размеры в SVG","type":"post"},{"date":"2017-01-13","href":"/adaptive-pixel-perfect","text":"Адаптивный Pixel Perfect","type":"post"},{"date":"2016-12-20","href":"/a11y-for-logotypes","text":"Логотип не отвечает или временно недоступен","type":"post"},{"date":"2016-11-23","href":"/svg-patterns","text":"SVG-паттерны","type":"post"},{"date":"2016-08-18","href":"/svg-bubble","text":"Мыльные пузыри на SVG","type":"post"},{"date":"2016-08-11","href":"/svg-gradients","text":"SVG-градиенты","type":"post"},{"date":"2016-02-12","href":"/funny-little-console","text":"Весёлая консолька","type":"post"},{"date":"2016-02-04","href":"/svg-masks","text":"SVG-маски","type":"post"},{"date":"2015-07-06","href":"/scroll-snap","text":"Умная прокрутка со Scroll Snap Points","type":"post"},{"date":"2014-08-11","href":"/css-animation-algorithms","text":"CSS-анимации для ротации изображений","type":"post"},{"date":"2014-08-10","href":"/animated-svg-mask","text":"Анимированные SVG-маски","type":"post"},{"date":"2014-07-26","href":"/svg-stroke","text":"Странности обводки в SVG","type":"post"},{"date":"2014-07-08","href":"/svg-preloaders","text":"SVG-прелоадеры","type":"post"},{"date":"2014-07-04","href":"/animated-gradients-2","text":"Анимируем градиенты ещё раз","type":"post"},{"date":"2014-06-15","href":"/background-blend-mode","text":"Background-blend-mode","type":"post"},{"date":"2014-04-17","href":"/svg-decoration","text":"Возможности оформления SVG","type":"post"},{"date":"2014-04-12","href":"/css-and-svg-masks","text":"CSS и SVG маски","type":"post"},{"date":"2014-04-06","href":"/nth-child","text":"Nth-child и nth-of-type","type":"post"},{"date":"2014-03-29","href":"/svg-icons","text":"SVG-иконки","type":"post"},{"date":"2014-03-27","href":"/svg-fill-and-stroke","text":"SVG: заливка и обводка","type":"post"},{"date":"2014-03-23","href":"/svg-path","text":"SVG-path","type":"post"},{"date":"2014-03-22","href":"/svg-groups-use","text":"SVG: группировка и переиспользование элементов","type":"post"},{"date":"2014-03-21","href":"/svg-shapes","text":"SVG-фигуры и трансформации","type":"post"},{"date":"2014-03-19","href":"/svg","text":"SVG","type":"post"},{"date":"2014-03-04","href":"/3d-and-gradients","text":"СSS-градиенты и 3D","type":"post"},{"date":"2014-02-23","href":"/shadowpainter","text":"Рисовалка анимированных теней","type":"post"},{"date":"2014-02-12","href":"/new-patterns","text":"Свежие CSS-паттерны","type":"post"},{"date":"2014-02-07","href":"/css-patterns","text":"CSS-паттерны","type":"post"},{"date":"2014-02-05","href":"/radial-gradients","text":"Радиальные градиенты","type":"post"},{"date":"2014-02-04","href":"/linear-gradients","text":"Линейные градиенты","type":"post"},{"date":"2014-01-25","href":"/tic-tac-toe","text":"Крестики-нолики на CSS","type":"post"},{"date":"2014-01-22","href":"/border-image","text":"Border-image","type":"post"},{"date":"2014-01-19","href":"/digital-watch","text":"Электронные часы на CSS и JS.","type":"post"},{"date":"2014-01-03","href":"/specifity","text":"Сколько весят селекторы?","type":"post"},{"date":"2014-01-02","href":"/unicode","text":"Символы юникода","type":"post"},{"date":"2013-12-22","href":"/content","text":"Свойство content","type":"post"},{"date":"2013-12-16","href":"/animation-for-gradients","text":"Анимируем CSS-градиенты","type":"post"},{"date":"2013-12-09","href":"/text-effects","text":"Текстовые эффекты","type":"post"},{"date":"2013-11-27","href":"/list-like-tree","text":"Древовидный список на CSS","type":"post"},{"date":"2013-11-20","href":"/css-selectors-part2","text":"Css-селекторы, часть 2","type":"post"},{"date":"2013-11-16","href":"/css-selectors","text":"Css-селекторы","type":"post"},{"date":"2013-10-22","href":"/kontekst-nalozheniya","text":"Контекст наложения","type":"post"},{"date":"2013-10-09","href":"/box-sizing","text":"Box-sizing","type":"post"},{"date":"2013-10-09","href":"/dva-sposoba-proshit-e-lement-po-krayu","text":"Два способа \"прошить\" элемент по краю","type":"post"},{"date":"2013-10-06","href":"/tsveta","text":"Цвета в CSS","type":"post"},{"date":"2013-10-04","href":"/fon-pod-strochkami-dobavlyaem-polya","text":"Фон под строчками: добавляем поля","type":"post"},{"date":"2013-09-29","href":"/box-shadow","text":"Box-shadow","type":"post"},{"date":"2013-09-27","href":"/css-figury-lepestok","text":"Css-фигуры: лепесток","type":"post"},{"date":"2013-09-26","href":"/3d-cube","text":"3D-куб","type":"post"},{"date":"2013-09-26","href":"/css-animation","text":"Css Animation","type":"post"},{"date":"2013-09-26","href":"/transform","text":"Transform","type":"post"},{"date":"2013-09-17","href":"/border-radius","text":"Border-radius","type":"post"},{"date":"2013-09-10","href":"/first-letter","text":"First letter","type":"post"},{"date":"2013-09-06","href":"/css-figury","text":"CSS-фигуры","type":"post"},{"date":"2013-09-06","href":"/eti-glaza-naprotiv","text":"Эти глаза напротив","type":"post"},{"date":"2013-09-04","href":"/strelki-s-pomoshh-yu-svojstva-border","text":"Стрелки с помощью свойства border","type":"post"},{"date":"2013-09-03","href":"/flexbox","text":"Flexbox","type":"post"}],"pages":[{"date":"2014-03-19","type":"page","href":"/pages/svg-links","text":"SVG: полезные ссылки"},{"date":"2013-11-16","type":"page","href":"/pages/css-selectors","text":"CSS-селекторы одной таблицей"},{"date":"2013-10-06","type":"page","href":"/pages/tablitsa-imenovanny-h-tsvetov","text":"Таблица именованных цветов"},{"date":"2013-09-27","type":"page","href":"/pages/transform-functions","text":"Функции Transform"},{"date":"2013-09-26","type":"page","href":"/pages/svojstva-animation","text":"Свойства Animation одной таблицей"},{"date":"2013-09-26","type":"page","href":"/pages/svojstva-transform","text":"Свойства Transform"},{"date":"2013-09-04","type":"page","href":"/pages/razny-j-sintaksis-flexbox","text":"Разный синтаксис Flexbox"},{"date":"2013-09-03","type":"page","href":"/pages/svojstva-flexbox","text":"Свойства Flexbox одной таблицей"}],"prevNext":{}},"__N_SSG":true}